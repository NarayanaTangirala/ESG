<div class="dashboard-container">
  <div class="top-section">
    <h1 class="dashboard-title">ESG Dashboard</h1>
    <div class="view-toggle">
      <button mat-button [class.active]="view === 'charts'" aria-label="Toggle Charts" (click)="setView('charts')">Charts</button>
      <button mat-button [class.active]="view === 'graphs'" aria-label="Toggle Graphs" (click)="setView('graphs')">Graphs</button>
    </div>
    <div class="actions">
      <button mat-raised-button color="primary" [matMenuTriggerFor]="importMenu">
        <mat-icon>cloud_upload</mat-icon> Import 
      </button>
      <mat-menu #importMenu="matMenu">
        <button mat-menu-item (click)="importCSV()"><mat-icon>insert_drive_file</mat-icon> Import CSV</button>
        <button mat-menu-item (click)="importXML()"><mat-icon>cloud_upload</mat-icon> Import XML</button>
      </mat-menu>
      <button mat-raised-button color="accent" [matMenuTriggerFor]="exportMenu">
        <mat-icon>cloud_download</mat-icon> Export
      </button>
      <mat-menu #exportMenu="matMenu">
        <button mat-menu-item (click)="exportCSV()"><mat-icon>insert_drive_file</mat-icon> Export CSV</button>
        <button mat-menu-item (click)="exportPDF()"><mat-icon>picture_as_pdf</mat-icon> Export PDF</button>
      </mat-menu>
    </div>
  </div>

  <div class="main-content">
    <div class="left-column">
      <mat-form-field appearance="outline">
        <mat-label>Search Company</mat-label>
        <input matInput [(ngModel)]="companyName" (keyup.enter)="handleSearch()">
        <mat-icon matSuffix>search</mat-icon>
      </mat-form-field>

      <mat-card>
        <mat-card-header>
          <mat-card-title>Companies</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <mat-selection-list [multiple]="false">
            <mat-list-option *ngFor="let company of searchedCompanies" 
                             [selected]="company === selectedCompany"
                             (click)="handleCompanySelect(company)">
              {{company}}
            </mat-list-option>
          </mat-selection-list>
        </mat-card-content>
      </mat-card>
    </div>

    <div class="right-column">
      <mat-card>
        <mat-card-header>
          <div class="header-content">
            <mat-card-title class="flex-container">
              <span>{{ view === 'charts' ? 'Chart' : 'Graph' }} Visualization for {{ selectedCompany || 'Selected Company' }}</span>
            </mat-card-title>
            <div class="view-toggle">
              <button *ngFor="let type of (view === 'charts' ? chartTypes : graphTypes)" 
                      mat-button 
                      [class.active]="selectedType === type" 
                      (click)="handleTypeChange({ value: type })">
                {{type | titlecase}}
              </button>
            </div>
          </div>
        </mat-card-header>                
                        
        <mat-card-content>
          <div class="chart-container" *ngIf="isBrowser">
            <canvas baseChart
              [data]="chartData"
              [options]="chartOptions"
              [type]="selectedType">
            </canvas>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
  </div>
</div>
